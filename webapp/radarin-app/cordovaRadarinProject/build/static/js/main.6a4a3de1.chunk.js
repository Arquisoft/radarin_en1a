(this.webpackJsonpcordovaRadarinProject=this.webpackJsonpcordovaRadarinProject||[]).push([[0],{129:function(e,t,n){},327:function(e,t,n){},331:function(e,t,n){},354:function(e,t){},355:function(e,t){},382:function(e,t){},384:function(e,t){},393:function(e,t){},395:function(e,t){},719:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n.n(a),s=n(63),o=n.n(s),i=(n(327),n(0)),c=n.n(i),l=n(13),u=n(7),p=n(8),d=n(11),h=n(12),f=n(22),m=(n(329),n(45)),g=[{featureType:"all",elementType:"geometry.fill",stylers:[{weight:"2.00"}]},{featureType:"all",elementType:"geometry.stroke",stylers:[{color:"#9c9c9c"}]},{featureType:"all",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#eeeeee"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#7b7b7b"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#c8d7d4"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#070707"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]}],b=(n(129),n(9)),y=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={selected:null},a}return Object(p.a)(n,[{key:"distanceBetweenCoordinates",value:function(e,t){return window.google.maps.geometry.spherical.computeDistanceBetween(new window.google.maps.LatLng({lat:this.props.lat,lng:this.props.lng}),new window.google.maps.LatLng({lat:e,lng:t}))}},{key:"renderInfoView",value:function(e){var t=this;return Object(b.jsx)(m.c,{position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},onCloseClick:function(){return t.setState({selected:null})},children:Object(b.jsx)("p",{children:e.name})})}},{key:"render",value:function(){var e=this,t=this;return this.props.locations.map((function(n){return t.distanceBetweenCoordinates(parseFloat(n.lat),parseFloat(n.lng))<parseFloat(t.props.range)?Object(b.jsxs)("div",{children:[Object(b.jsx)(m.e,{title:n.name,position:{lat:parseFloat(n.lat),lng:parseFloat(n.lng)},icon:{url:void 0===n.photo?"/user.png":n.photo,scaledSize:new window.google.maps.Size(20,20)},onClick:function(){return t.setState({selected:n})}},"marker-"+n.name),e.state.selected===n?Object(b.jsx)("div",{children:t.renderInfoView(n)}):null]}):null}))}}]),n}(r.a.Component),j=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderInfoView",value:function(e){var t=this;return e.selected=!0,Object(b.jsx)(m.c,{position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},onCloseClick:function(){t.setState({selected:null}),e.selected=!1},children:Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:e.name}),"./logo192.png"!==e.photo?Object(b.jsx)("img",{className:"popup-img",src:e.photo,alt:"error loading"}):null]})})}},{key:"render",value:function(){var e=this,t=this;return this.props.locations.map((function(n){return t.distanceBetweenCoordinates(parseFloat(n.lat),parseFloat(n.lng))<parseFloat(t.props.range)?Object(b.jsxs)("div",{children:[Object(b.jsx)(m.e,{title:n.name,position:{lat:parseFloat(n.lat),lng:parseFloat(n.lng)},icon:{url:"./logo192.png",scaledSize:new window.google.maps.Size(20,20)},onClick:function(){return t.setState({selected:n})}},n.pod),e.state.selected===n?Object(b.jsx)("div",{children:t.renderInfoView(n)}):null]}):null}))}}]),n}(y),v={width:"100vw",height:"100vh"},x=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={selected:null,center:{lat:a.props.lat,lng:a.props.lng},mapRef:null},a.options={styles:g,zoomControl:!0,mapTypeControl:!0,mapTypeControlOptions:{position:window.google.maps.ControlPosition.TOP_CENTER,style:window.google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapTypeIds:[window.google.maps.MapTypeId.HYBRID,window.google.maps.MapTypeId.ROADMAP,window.google.maps.MapTypeId.SATELLITE,window.google.maps.MapTypeId.TERRAIN]}},a}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"map-Container",children:Object(b.jsxs)(m.b,{id:"radarin-map",onLoad:function(t){return e.setState({mapRef:t})},mapContainerStyle:v,zoom:this.props.zoom,center:this.state.center,options:this.options,onCenterChanged:function(){return null!==e.state.mapRef&&e.setState({center:e.state.mapRef.getCenter()})},children:[Object(b.jsx)(m.e,{position:{lat:this.props.lat,lng:this.props.lng},icon:{url:this.props.myIcon,scaledSize:new window.google.maps.Size(36,36)}}),Object(b.jsx)(y,{locations:this.props.friends,setSelected:this.setSelected,lat:this.props.lat,lng:this.props.lng,range:this.props.range}),Object(b.jsx)(j,{locations:this.props.locations,setSelected:this.setSelected,lat:this.props.lat,lng:this.props.lng,range:this.props.range,deleteLocation:function(t){return e.props.deleteLocation(t)}}),Object(b.jsx)(m.a,{"data-testid":"friends-circle",center:{lat:this.props.lat,lng:this.props.lng},radius:parseFloat(this.props.range)})]})})}}]),n}(r.a.Component),O=n(31),w=n(724),k=n(727),S=n(722),T=n(728),L=n(723),C=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"distanceTo",value:function(e,t){var n=this.props.pos[0],a=this.props.pos[1],r=e*Math.PI/180,s=n*Math.PI/180,o=(n-e)*Math.PI/180,i=(a-t)*Math.PI/180,c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r)*Math.cos(s)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}},{key:"render",value:function(){var e=this;return this.props.friends.map((function(t){return e.distanceTo(parseFloat(t.lat),parseFloat(t.lng))<e.props.range?Object(b.jsx)(S.a,{position:[t.lat,t.lng],icon:new O.Icon({iconUrl:void 0===t.photo?"./user.png":t.photo,iconSize:new O.Point(20,20)}),children:Object(b.jsx)(L.a,{children:t.name})}):null}))}}]),n}(r.a.Component),I=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return this.props.locations.map((function(t){return e.distanceTo(parseFloat(t.lat),parseFloat(t.lng))<e.props.range?Object(b.jsx)(S.a,{position:[t.lat,t.lng],icon:new O.Icon({iconUrl:"./logo192.png",iconSize:new O.Point(20,20)}),children:Object(b.jsxs)(L.a,{children:[Object(b.jsx)("p",{children:t.name}),"./logo192.png"!==t.photo?Object(b.jsx)("img",{className:"popup-img",src:t.photo,alt:"error loading"}):null]})}):null}))}}]),n}(C),M=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={pos:[e.lat,e.lng],myIcon:a.props.myIcon},a}return Object(p.a)(n,[{key:"handleRangeChange",value:function(e){this.setState({range:e.target.value})}},{key:"handlePopupClose",value:function(e){console.log(e.popup)}},{key:"render",value:function(){return Object(b.jsxs)(w.a,{center:this.state.pos,zoom:this.props.zoom,scrollWheelZoom:!0,children:[Object(b.jsx)(k.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(b.jsx)(S.a,{position:this.state.pos,icon:new O.Icon({iconUrl:void 0===this.state.myIcon?"./user.png":this.props.myIcon,iconSize:new O.Point(36,36)})}),Object(b.jsx)(C,{friends:this.props.friends,pos:this.state.pos,range:this.props.range}),Object(b.jsx)(I,{locations:this.props.locations,pos:this.state.pos,range:this.props.range}),Object(b.jsx)(T.a,{center:this.state.pos,radius:this.props.range})]})}}]),n}(r.a.Component),N=(n(331),n(125)),F=n.n(N),P=(n(336),n(37)),E=n(717).default,R=P.fetch,_=new(n(716))(P),B=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,[{key:"saveLocationToSolid",value:function(){var e=Object(l.a)(c.a.mark((function e(t,n){var a,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t+","+n,e.next=3,this.getCurrentSession();case 3:return r=e.sent,e.next=6,r.webId.replace("profile/card#me","radarin/last.txt");case 6:if(s=e.sent,null==t||null==n){e.next=10;break}return e.next=10,_.postFile(s,new Blob([a]));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCurrentSession",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.currentSession();case 2:if(t=e.sent){e.next=8;break}return"./popup.html",e.next=7,P.popupLogin({popupUri:"./popup.html"});case 7:t=e.sent;case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadStoredLocationFromSolid",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,a,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentSession();case 2:return t=e.sent,n=t.webId.replace("profile/card#me","radarin/stored_locations.json"),e.next=6,_.itemExists(n);case 6:if(e.sent){e.next=9;break}return e.next=9,_.postFile(n,new Blob);case 9:return a=t.webId.replace("profile/card#me","radarin/stored_locations.json"),e.next=12,R(a).then((function(e){return 200===e.status?e.text():void 0}));case 12:if(void 0!==(r=e.sent)&&""!==r&&null!==r){e.next=15;break}return e.abrupt("return");case 15:return console.log(r),void 0===(s=JSON.parse(r))&&(s=[]),e.abrupt("return",s);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveStoredLocationToSolid",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentSession();case 2:return n=e.sent,a=n.webId.replace("profile/card#me","radarin/stored_locations.json"),r=JSON.stringify(t),e.next=7,_.postFile(a,new Blob([r]));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handlePermission",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,r,s,o,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentSession();case 2:return n=e.sent,a=n.webId.replace("profile/card#me","radarin/last.txt"),e.next=6,_.aclUrlParser(a);case 6:if(r=e.sent,t.permission){e.next=14;break}return t.permission=!0,e.next=11,_.acl.addUserMode(r,[{agent:t.pod}],["Read"]);case 11:r=e.sent,e.next=18;break;case 14:return t.permission=!1,e.next=17,_.acl.deleteUserMode(r,[{agent:t.pod}],["Read"]);case 17:r=e.sent;case 18:return s=[r],e.next=21,_.acl.createContent("radarin/last.txt",s);case 21:return o=e.sent,e.next=24,_.getItemLinks(a,{links:"include_possible"});case 24:i=e.sent,l=i.acl,_.putFile(l,o,"text/turtle");case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkFriendsPermission",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,r,s,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentSession();case 2:return n=e.sent,a=n.webId.replace("profile/card#me","radarin/last.txt"),e.next=6,_.aclUrlParser(a);case 6:return r=e.sent,s=[r],e.next=10,_.acl.createContent("radarin/last.txt",s);case 10:o=e.sent,t.permission=o.includes(t.pod);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMyPhoto",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentSession();case 2:return t=e.sent,e.abrupt("return",E[t.webId]["vcard:hasPhoto"].then((function(e){var t="./user.png";return void 0!==e&&(t=e.value),t})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadFriendsFromSolid",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,a,r,s,o,i,l,u,p,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.getCurrentSession();case 3:n=e.sent,a=E[n.webId],r=!0,s=!1,e.prev=7,i=Object(f.a)(a.friends);case 9:return e.next=11,i.next();case 11:return l=e.sent,r=l.done,e.next=15,l.value;case 15:if(u=e.sent,r){e.next=35;break}return p=u,e.t0="",e.next=21,E[p];case 21:return e.t1=e.sent,e.t2=e.t0.concat.call(e.t0,e.t1),e.next=25,E[p].name.value;case 25:return e.t3=e.sent,e.next=28,E[p]["vcard:hasPhoto"].value;case 28:e.t4=e.sent,d={pod:e.t2,name:e.t3,photo:e.t4,lat:null,lng:null,ring:3,permission:null},this.checkFriendsPermission(d),t.push(d);case 32:r=!0,e.next=9;break;case 35:e.next=41;break;case 37:e.prev=37,e.t5=e.catch(7),s=!0,o=e.t5;case 41:if(e.prev=41,e.prev=42,r||null==i.return){e.next=46;break}return e.next=46,i.return();case 46:if(e.prev=46,!s){e.next=49;break}throw o;case 49:return e.finish(46);case 50:return e.finish(41);case 51:return e.abrupt("return",t);case 52:case"end":return e.stop()}}),e,this,[[7,37,41,51],[42,,46,50]])})));return function(){return e.apply(this,arguments)}}()},{key:"getFriendLocation",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pod.split("profile")[0],e.next=3,R(n+"/radarin/last.txt").then((function(e){return 200===e.status?e.text():null}));case 3:if(null!==(a=e.sent)){e.next=6;break}return e.abrupt("return",null);case 6:return r=a.split(","),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),z=n(729),D=n(725),A=n(730),U=n(726),W=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return Object(b.jsx)("table",{className:"locations",children:Object(b.jsx)("tbody",{children:void 0!==this.props.locations?this.props.locations.map((function(t){return Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{className:t.selected?"activeLocation":"inactiveLocation",children:t.name},t.name),Object(b.jsx)("th",{children:Object(b.jsx)("button",{className:"button-delete-location",onClick:function(){return e.props.deleteLocation(t)},children:"\u2796"})})]})})):null})})}}]),n}(r.a.Component),q=n(82),K=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={name:""},a.handleSubmit=a.handleSubmit.bind(Object(q.a)(a)),a}return Object(p.a)(n,[{key:"handleChangeName",value:function(e){this.setState({name:e.target.value})}},{key:"handleSubmit",value:function(e){this.props.addNewLocation(this.state.name),e.preventDefault()}},{key:"render",value:function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{className:"friends-title",children:"Store your current location:"}),Object(b.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(b.jsx)("input",{id:"newLocationText",type:"text",name:"name",value:this.state.name,onChange:this.handleChangeName.bind(this),placeholder:"Name of the location"}),Object(b.jsx)("input",{type:"submit",value:"\u2795",className:"button-add-location"})]})]})}}]),n}(r.a.Component),V=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.props.friends;return void 0!==t?Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{className:"friends-title",children:"Friends list:"}),Object(b.jsx)("table",{id:"friends",children:Object(b.jsx)("tbody",{children:t.map((function(t){var n=t.photo;return void 0===n&&(n="/user.png"),Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{className:"profile-pic",children:Object(b.jsx)("img",{width:"24px",height:"24px",src:n,alt:"Load error"})},"friend-th1-"+t.pod),Object(b.jsx)("th",{children:Object(b.jsx)("a",{id:"friend-"+t.pod,target:"_blank",rel:"noreferrer",className:"friendLink",href:t.pod,children:t.name})},"friend-th2-"+t.pod),Object(b.jsx)("th",{children:Object(b.jsx)("button",{title:"Enable/Disable friend's permissions",className:"button-permission",id:"button-"+t.pod,onClick:function(){return e.props.handlePermission(t)},children:t.permission?"\u2714\ufe0f":"\u274c"})},"friend-th3-"+t.pod)]},"friend-tr-"+t.pod)}))})})]}):Object(b.jsx)("div",{})}}]),n}(r.a.Component),H=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={mapType:e.mapType},a}return Object(p.a)(n,[{key:"displayMenu",value:function(){0===document.getElementById("sidemenu").style.width.toString().length?(document.getElementById("sidemenu").style.width="25%",document.getElementById("sidemenu").style.minWidth="400px",document.getElementById("ShowMenu").style.transform="scaleX(-1)"):(document.getElementById("sidemenu").style.width="",document.getElementById("sidemenu").style.minWidth="0px",document.getElementById("ShowMenu").style.transform="scaleX(1)")}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{id:"sidemenu",children:[Object(b.jsx)(z.a,{children:Object(b.jsx)(D.a,{className:"button-Login",popup:"./popup.html"})}),Object(b.jsxs)(A.a,{children:[Object(b.jsx)(K,{addNewLocation:function(t){return e.props.handleNewLocation(t)}}),Object(b.jsx)("hr",{}),Object(b.jsx)(W,{locations:this.props.myLocations,deleteLocation:function(t){return e.props.handleDeleteLocation(t)}}),Object(b.jsx)("hr",{}),Object(b.jsx)(V,{friends:this.props.friends,handlePermission:function(t){return e.props.solid.handlePermission(t)}}),Object(b.jsx)("hr",{}),Object(b.jsx)("button",{onClick:function(){return e.props.changeMapType()},className:"button-ChangeMap",children:"Change Map"}),Object(b.jsx)("hr",{}),Object(b.jsx)(U.a,{className:"button-Logout"})]}),Object(b.jsx)("button",{id:"ShowMenu",onClick:function(){return e.displayMenu()},children:Object(b.jsx)("img",{src:"./oMenu.png",alt:"_"})})]})}}]),n}(r.a.Component),J=new B,Y=["places","geometry"],G=window.google,X=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={currentLat:null,currentLng:null,friends:[],myPhoto:"./user.png",myLocations:[],mapType:"gmap",range:6e3,zoom:13},a.getLocation(),a.loadLocations(),a}return Object(p.a)(n,[{key:"getLocation",value:function(){var e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){e.setAndSaveLocation(t)}))}},{key:"setAndSaveLocation",value:function(e){this.setState({currentLat:e.coords.latitude,currentLng:e.coords.longitude}),J.saveLocationToSolid(this.state.currentLat,this.state.currentLng)}},{key:"handleNewLocation",value:function(e){if(""!==e){for(var t={lat:this.state.currentLat,lng:this.state.currentLng,name:e,photo:"./logo192.png"},n=!1,a=0;a<this.state.myLocations.length;a++)t.name===this.state.myLocations[a].name&&(n=!0);if(n)this.addNewNotification("Repeated location name not allowed!","Please, add an unique tag to save your location","danger");else{var r=this.state.myLocations.concat(t);this.setState({myLocations:r}),document.getElementById("newLocationText").value="",J.saveStoredLocationToSolid(r)}}else this.addNewNotification("Empty location name not allowed!","Please, add an unique tag to save your location","danger")}},{key:"handleDeleteLocation",value:function(e){var t=this.state.myLocations.slice();t.splice(t.indexOf(e),1),this.setState({myLocations:t}),J.saveStoredLocationToSolid()}},{key:"loadLocations",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.loadStoredLocationFromSolid();case 2:return void 0===(t=e.sent)&&(t=[]),this.setState({myLocations:t}),e.next=7,J.loadFriendsFromSolid();case 7:return n=e.sent,this.setState({friends:n}),e.next=11,J.getMyPhoto();case 11:a=e.sent,this.setState({myPhoto:a}),this.reloadRing(3),this.startTimer();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reloadRing",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,a,r,s,o,i,l,u,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=this.state.friends)){e.next=39;break}a=!0,r=!1,e.prev=4,o=Object(f.a)(n);case 6:return e.next=8,o.next();case 8:return i=e.sent,a=i.done,e.next=12,i.value;case 12:if(l=e.sent,a){e.next=23;break}if((u=l).ring!==t){e.next=20;break}return e.next=18,J.getFriendLocation(u);case 18:null!==(p=e.sent)?(document.getElementById("friend-"+u.pod).style.color="lime",u.lat=p[0],u.lng=p[1],u.ring=this.computeRing(u),1!==u.ring||1===t||u.hasExited||(this.notifyNewFriendEntered(u.name),u.hasExited=!0),1!==u.ring&&1===t&&u.hasExited&&(this.notifyNewFriendExited(u.name),u.hasExited=!1)):document.getElementById("friend-"+u.pod).style.color="grey";case 20:a=!0,e.next=6;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(4),r=!0,s=e.t0;case 29:if(e.prev=29,e.prev=30,a||null==o.return){e.next=34;break}return e.next=34,o.return();case 34:if(e.prev=34,!r){e.next=37;break}throw s;case 37:return e.finish(34);case 38:return e.finish(29);case 39:this.setState({friends:n});case 40:case"end":return e.stop()}}),e,this,[[4,25,29,39],[30,,34,38]])})));return function(t){return e.apply(this,arguments)}}()},{key:"computeRing",value:function(e){var t={lat:parseFloat(e.lat),lng:parseFloat(e.lng)},n=this.distanceBetweenCoordinates(t.lat,t.lng);return n<=this.state.range?1:n<=1.5*this.state.range?2:n>1.5*this.state.range?3:void 0}},{key:"distanceBetweenCoordinates",value:function(e,t){var n=parseFloat(this.state.currentLat),a=parseFloat(this.state.currentLng),r=e*Math.PI/180,s=n*Math.PI/180,o=(n-e)*Math.PI/180,i=(a-t)*Math.PI/180,c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r)*Math.cos(s)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}},{key:"startTimer",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this,setInterval((function(){t.reloadRing(1)}),1e3),setInterval((function(){t.reloadRing(2)}),1e4),setInterval((function(){t.reloadRing(3)}),6e4);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reloadAllRings",value:function(){this.reloadRing(1),this.reloadRing(2),this.reloadRing(3)}},{key:"handRangeChange",value:function(e){this.setState({range:e.target.value}),this.reloadAllRings()}},{key:"notifyNewFriendEntered",value:function(e){var t="Your friend "+e+" is near you!";this.addNewNotification("New friend nearby!",t,"success")}},{key:"notifyNewFriendExited",value:function(e){var t="Your friend "+e+" went away!";this.addNewNotification("Friend out of the radar!",t,"warning")}},{key:"addNewNotification",value:function(e,t,n){N.store.addNotification({title:e,message:t,type:n,insert:"bottom",container:"bottom-left",animationIn:["animate__animated","animate__fadeIn"],animationOut:["animate__animated","animate__fadeOut"],dismiss:{duration:5e3,onScreen:!0}}),new Audio("n_sound.mp3").play()}},{key:"changeMapType",value:function(){"gmap"===this.state.mapType?(this.setState({mapType:"lmap"}),document.getElementById("ShowMenu").style.marginTop="10vh",console.log(this.state.myLocations)):(this.setState({mapType:"gmap"}),document.getElementById("ShowMenu").style.marginTop="1vh")}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{className:"App",children:[G?null:Object(b.jsx)(m.d,{id:"script-loader",googleMapsApiKey:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GOOGLE_KEY,libraries:Y,children:" "}),Object(b.jsx)(H,{handleNewLocation:function(t){return e.handleNewLocation(t)},myLocations:this.state.myLocations,solid:J,friends:this.state.friends,changeMapType:function(t){return e.changeMapType(t)},handleDeleteLocation:function(t){return e.handleDeleteLocation(t)}}),Object(b.jsx)(F.a,{}),Object(b.jsx)("div",{className:"slider-container",children:Object(b.jsx)("input",{className:"slider",type:"range",min:"1000",max:"100000",step:"500",value:this.state.range,onChange:this.handRangeChange.bind(this)})}),this.state.currentLat&&this.state.currentLng?"gmap"===this.state.mapType&&void 0!==window.google?Object(b.jsx)(x,{lat:this.state.currentLat,lng:this.state.currentLng,friends:this.state.friends,myIcon:this.state.myPhoto,locations:this.state.myLocations,range:this.state.range,deleteLocation:function(t){return e.handleDeleteLocation(t)},zoom:this.state.zoom}):"lmap"===this.state.mapType?Object(b.jsx)(M,{lat:this.state.currentLat,lng:this.state.currentLng,friends:this.state.friends,myIcon:this.state.myPhoto,locations:this.state.myLocations,range:this.state.range,zoom:this.state.zoom}):Object(b.jsx)("div",{}):Object(b.jsx)("div",{className:"loader"})]})}}]),n}(r.a.Component),Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,731)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),s(e),o(e)}))},Q=function(){o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(X,{})}),document.getElementById("root"))};window.cordova?document.addEventListener("deviceready",(function(){Q()}),!1):Q(),Z()}},[[719,1,2]]]);
//# sourceMappingURL=main.6a4a3de1.chunk.js.map